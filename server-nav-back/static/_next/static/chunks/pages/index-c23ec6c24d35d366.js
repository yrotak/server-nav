(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5557:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(2508)}])},2508:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return b}});var o=n(5893),s=n(9008),r=n.n(s),a=n(7294),i=n(1633),u=n.n(i),l=n(594),c=n(6600),d=n.n(c);let p=e=>{let{setCurrentChallenge:t,setToken:n}=e,[s,r]=(0,a.useState)(""),[i,u]=(0,a.useState)("");return(0,o.jsxs)("form",{className:d().form,onSubmit(e){e.preventDefault(),l.Z.post("".concat(window.location.origin,"/api/v1/Users/login"),{username:s,password:i}).then(e=>{n(e.data.token),t(1)})},children:[(0,o.jsx)("input",{type:"text",placeholder:"Username",alt:"Username",className:d().input,value:s,onChange:e=>r(e.target.value)}),(0,o.jsx)("input",{type:"password",placeholder:"Password",alt:"Password",className:d().input,value:i,onChange:e=>u(e.target.value)}),(0,o.jsx)("button",{className:d().button,children:"Login"})]})};var m=n(6738),h=n.n(m);let f=e=>{let{setCurrentChallenge:t,setToken:n,Token:s}=e,[r,i]=(0,a.useState)("");return(0,o.jsxs)("form",{className:h().form,onSubmit(e){e.preventDefault(),l.Z.post("".concat(window.location.origin,"/api/v1/Users/totp"),{code:r},{headers:{Authorization:s}}).then(e=>{n(e.data.token),t(2)})},children:[(0,o.jsx)("input",{type:"text",placeholder:"2FA Code",alt:"2FA Code",className:h().input,value:r,onChange:e=>i(e.target.value)}),(0,o.jsx)("button",{className:h().button,children:"Verify"})]})};var _=n(7316),g=n.n(_),x=n(7347),w=n.n(x);let k=e=>{let{setLoggedIn:t,setToken:n,Token:s,updateUserData:r}=e,[i,u]=(0,a.useState)(!1),[c,d]=(0,a.useState)({}),[p,m]=(0,a.useState)("");return((0,a.useEffect)(()=>{g().isSupported().then(e=>{u(!e),e&&l.Z.post("".concat(window.location.origin,"/api/v1/Users/signRequest"),{},{headers:{Authorization:s}}).then(e=>{d(e.data.signed_request),m(e.data.challenge_str)})})},[]),i)?(0,o.jsx)("p",{children:"U2F is not supported on this browser."}):(0,o.jsxs)("form",{className:w().form,onSubmit(e){e.preventDefault(),console.log(c,c.registeredKeys),window.u2f.sign(c.appId,c.challenge,c.registeredKeys,e=>{0==e.errorCode&&l.Z.post("".concat(window.location.origin,"/api/v1/Users/signResponse"),{challenge_str:p,sign_data:JSON.stringify(e)},{headers:{Authorization:s}}).then(e=>{n(e.data.token),function(e,t,n){let o=new Date;o.setTime(o.getTime()+1728e5);let s="expires="+o.toUTCString();document.cookie=e+"="+t+";"+s+";path=/"}("token",e.data.token,0),t(!0),r()})})},children:[(0,o.jsx)("p",{children:"Please use your U2F key to continue"}),(0,o.jsx)("button",{className:w().button,children:"Authentify"})]})};var v=n(4379);function b(){let[e,t]=(0,a.useState)(0),[n,s]=(0,a.useState)(""),[i,c]=(0,a.useState)(!1),[d,m]=(0,a.useState)({});function h(){let e=function(e){let t=e+"=",n=decodeURIComponent(document.cookie).split(";");for(let o=0;o<n.length;o++){let s=n[o];for(;" "==s.charAt(0);)s=s.substring(1);if(0==s.indexOf(t))return s.substring(t.length,s.length)}return""}("token");e&&l.Z.post("".concat(window.location.origin,"/api/v1/Users/checkToken"),{},{headers:{Authorization:e}}).then(t=>{s(e),m(t.data),c(!0),v.fn.success("Welcome back captain !","Logged In !")})}return(0,a.useEffect)(()=>{h()},[]),(0,o.jsxs)("div",{className:u().container,children:[(0,o.jsxs)(r(),{children:[(0,o.jsx)("title",{children:"Server portal"}),(0,o.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,o.jsx)("main",{className:u().main,children:i?(0,o.jsx)(o.Fragment,{children:(0,o.jsx)("img",{className:u().logo,src:"/logo.png"})}):(function(){return[(0,o.jsx)(p,{setCurrentChallenge:t,setToken:s},0),(0,o.jsx)(f,{setCurrentChallenge:t,setToken:s,Token:n},1),(0,o.jsx)(k,{setLoggedIn:c,setToken:s,Token:n,updateUserData:h},2)][e]}).call(this)})]})}},1633:function(e){e.exports={container:"Home_container__97eC3",main:"Home_main__OVLM4",title:"Home_title__q0Qg4",logo:"Home_logo__FLQOc"}},6600:function(e){e.exports={form:"LoginForm_form__F4vYR",input:"LoginForm_input__yqXxK",button:"LoginForm_button__qshdr"}},6738:function(e){e.exports={form:"TotpForm_form__xfWNf",input:"TotpForm_input__ZyqOl",button:"TotpForm_button__R1JUI"}},7347:function(e){e.exports={form:"U2fForm_form__mz4nD",button:"U2fForm_button__BYrQ8"}}},function(e){e.O(0,[582,774,888,179],function(){return e(e.s=5557)}),_N_E=e.O()}]);